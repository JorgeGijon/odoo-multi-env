#-----------------------------------------------------------------------------
# ğŸ› ï¸ Ejecutar en Desarrollo (Windows):    
# docker-compose -f docker-compose.yml -f docker-compose.override.dev.yml up -d
#-----------------------------------------------------------------------------

services:
  # ğŸ—ï¸ Odoo - AplicaciÃ³n ERP en Desarrollo, Stage y ProducciÃ³n
  odoo:
    container_name: ${INSTANCE:-prueba}-odoo
    ports:
      - "${ODOO_PORT:-8069}:8069"  # ğŸ“Œ Puerto HTTP de Odoo
    environment:
      - ODOO_ENV=${ODOO_ENV:-development}  # ğŸ—ï¸ Define el entorno dinÃ¡micamente
      - DEBUGPY_PORT=${DEBUGPY_PORT:-5678}  # ğŸ” Puerto para DebugPy (Solo en desarrollo)
      - PGHOST=${PGHOST:-prueba-postgres}  # ğŸ˜ ConexiÃ³n a PostgreSQL
      - PGPORT=${PGPORT:-5432}  
      - PGUSER=${PGUSER:-odoo}  
      - PGPASSWORD=${PGPASSWORD:-odoo_password}  
      - PGDATABASE=${PGDATABASE:-odoo_dev}  
      - SESSION_REDIS_HOST=${SESSION_REDIS_HOST:-prueba-redis}  
      - SESSION_REDIS_PORT=${SESSION_REDIS_PORT:-6380}  
    networks:
      - odoo-network

    # ğŸ”¹ **Activar DebugPy solo en Desarrollo**
    profiles:
      - "dev"
    command: 
      - "python3" 
      - "-m" 
      - "debugpy" 
      - "--listen" 
      - "0.0.0.0:5678" 
      - "--wait-for-client" 
      - "/usr/bin/odoo"  # ğŸ—ï¸ Odoo esperarÃ¡ la conexiÃ³n del depurador antes de ejecutarse


  # ğŸ˜ PostgreSQL en desarrollo
  postgres:
    env_file:
      - .env.dev
    container_name: ${INSTANCE:-dev}-postgres
    ports:
      - "5433:5432"  # ğŸ“Œ Puerto alternativo para PostgreSQL en Dev

  # ğŸ”´ Redis en desarrollo
  redis:
    env_file:
      - .env.dev
    container_name: ${INSTANCE:-dev}-redis
    ports:
      - "6380:6379"  # ğŸ“Œ Puerto alternativo para Redis en Dev
