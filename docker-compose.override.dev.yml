# ğŸ“Œ ConfiguraciÃ³n especÃ­fica para el entorno de Desarrollo
# Se ejecuta con:
# docker-compose -f docker-compose.yml -f docker-compose.override.dev.yml up -d --remove-orphans

services:
  # ğŸ—ï¸ Odoo en modo Desarrollo
  odoo:
    container_name: dev-odoo
    environment:
      - ODOO_ENV=development  # ğŸ”¹ Define el entorno (el entrypoint gestiona todo lo demÃ¡s)
    networks:
      - odoo-network
    volumes:
      - ./addons:/mnt/custom-addons                      # ğŸ”Œ Monta los mÃ³dulos personalizados
      - ./odoo-src:/usr/lib/python3/dist-packages/odoo   # ğŸ–¥ï¸ Acceso al cÃ³digo fuente de Odoo
      - ./data/odoo:/var/lib/odoo                        # ğŸ’¾ Almacena datos persistentes de Odoo
    command: 
      - "python3" 
      - "-m" 
      - "debugpy" 
      - "--listen" 
      - "0.0.0.0:5678" 
      - "--wait-for-client" 
      - "/usr/bin/odoo"  # ğŸ—ï¸ Odoo esperarÃ¡ la conexiÃ³n del depurador antes de ejecutarse

  # ğŸ˜ PostgreSQL en Desarrollo
  postgres:
    container_name: dev-postgres
    environment:
      - ODOO_ENV=development  # ğŸ“Œ Es suficiente para que el entrypoint asigne variables
    networks:
      - odoo-network
    volumes:
      - ./data/postgres:/var/lib/postgresql/data  # ğŸ’¾ Datos persistentes de PostgreSQL

  # ğŸ”´ Redis en Desarrollo
  redis:
    container_name: dev-redis
    image: redis:latest
    restart: unless-stopped
    environment:
      - ODOO_ENV=development  # ğŸ“Œ Redis tambiÃ©n se configura en funciÃ³n del entorno
    networks:
      - odoo-network
    ports:
      - "6380:6379"  # ğŸ”´ Expone Redis en otro puerto para evitar conflictos

  # ğŸ›¢ï¸ PGBackup en Desarrollo
  pgbackup:
    container_name: dev-pgbackup
    environment:
      - ODOO_ENV=development  # ğŸ“Œ El entrypoint manejarÃ¡ las variables necesarias
    networks:
      - odoo-network
    volumes:
      - ./backups:/backups  # ğŸ’¾ Carpeta local para backups
